import{_ as D}from"./DbuFvnLP.js";import{m as I,f as P,h as $,p as A,r as i,q as R,c as r,a as e,i as w,b as k,w as C,u as s,s as N,v as u,x as p,t as d,o as c,d as M,y as L}from"#entry";import{u as W}from"./b2E7qtaH.js";import{u as Y}from"./CUMa_dbu.js";import{a as z}from"./BDG_tvSz.js";const G={class:"min-h-screen bg-gradient-to-br from-primary-very-light to-primary-light flex items-center justify-center p-4",style:{display:"flex !important","align-items":"center !important","justify-content":"center !important","min-height":"100vh !important"}},H={class:"max-w-md w-full space-y-8"},J={class:"text-center"},K={class:"card p-8"},O={class:"space-y-4"},Q={class:"relative"},X={class:"relative"},Z={class:"relative"},ee=["disabled"],te={key:0,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg"},se={class:"text-red-700 text-sm"},ae={class:"card p-8"},oe={class:"space-y-4"},le={class:"relative"},ne={class:"relative"},ie=["disabled"],re={key:0,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg"},de={class:"text-red-700 text-sm"},ce={key:2,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},me={class:"text-green-700 font-medium"},ue={class:"text-center"},xe={__name:"login",async setup(pe){let g,h;const{login:V,setupAdmin:q,isAuthenticated:E}=I(),{getSiteSettings:U}=W(),{initLanguage:B}=Y(),y=([g,h]=P(()=>U()),g=await g,h(),g);$(()=>{B()});const n=A({email:"",password:""}),a=A({name:"",email:"",password:""}),x=i(!1),f=i(!1),b=i(!1),m=i(""),v=i(""),_=i("");R(E,async l=>{l&&await L("/agency-cms/manage")},{immediate:!0});const T=async()=>{f.value=!0,m.value="";const l=await V(n.email,n.password);l.success?(console.log("Login successful, waiting for cookie to be set..."),setTimeout(async()=>{console.log("Redirecting to /manage"),await L("/manage",{replace:!0})},500)):(m.value=l.error,f.value=!1)},F=async()=>{b.value=!0,v.value="";const l=await q(a.email,a.password,a.name);l.success?(_.value="Admin account created successfully! You can now login.",x.value=!1,a.name="",a.email="",a.password=""):v.value=l.error,b.value=!1},j=()=>{x.value=!0,m.value=""};return z({title:`Admin Login | ${y.siteName} CMS`,description:`Login to access the ${y.siteName} CMS dashboard`,robots:"noindex, nofollow"}),(l,t)=>{const S=D;return c(),r("div",G,[e("div",H,[e("div",J,[k(S,{to:"/agency-cms",class:"text-3xl font-bold gradient-text"},{default:C(()=>[M(d(s(y).siteName),1)]),_:1}),t[5]||(t[5]=e("h2",{class:"mt-6 text-3xl font-extrabold text-gray-900"},"Admin Login",-1)),t[6]||(t[6]=e("p",{class:"mt-2 text-sm text-gray-600"},"Sign in to access the CMS dashboard",-1))]),s(x)?(c(),r("form",{key:0,onSubmit:N(F,["prevent"]),class:"mt-8 space-y-6"},[e("div",K,[t[10]||(t[10]=e("div",{class:"mb-6"},[e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Setup Admin Account"),e("p",{class:"text-gray-600"},"Create the first admin account to access the CMS.")],-1)),e("div",O,[e("div",Q,[u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).name=o),type:"text",placeholder:" ",class:"form-input peer",required:""},null,512),[[p,s(a).name]]),t[7]||(t[7]=e("label",{class:"floating-label"},"Full Name",-1))]),e("div",X,[u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s(a).email=o),type:"email",placeholder:" ",class:"form-input peer",required:""},null,512),[[p,s(a).email]]),t[8]||(t[8]=e("label",{class:"floating-label"},"Email Address",-1))]),e("div",Z,[u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s(a).password=o),type:"password",placeholder:" ",class:"form-input peer",minlength:"6",required:""},null,512),[[p,s(a).password]]),t[9]||(t[9]=e("label",{class:"floating-label"},"Password (min 6 characters)",-1))])]),e("button",{type:"submit",disabled:s(b),class:"btn-primary w-full mt-6"},d(s(b)?"Creating...":"Create Admin Account"),9,ee),s(v)?(c(),r("div",te,[e("p",se,d(s(v)),1)])):w("",!0)])],32)):(c(),r("form",{key:1,onSubmit:N(T,["prevent"]),class:"mt-8 space-y-6"},[e("div",ae,[e("div",oe,[e("div",le,[u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s(n).email=o),type:"email",placeholder:" ",class:"form-input peer",required:""},null,512),[[p,s(n).email]]),t[11]||(t[11]=e("label",{class:"floating-label"},"Email Address",-1))]),e("div",ne,[u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s(n).password=o),type:"password",placeholder:" ",class:"form-input peer",required:""},null,512),[[p,s(n).password]]),t[12]||(t[12]=e("label",{class:"floating-label"},"Password",-1))])]),e("button",{type:"submit",disabled:s(f),class:"btn-primary w-full mt-6"},d(s(f)?"Signing in...":"Sign In"),9,ie),s(m)?(c(),r("div",re,[e("p",de,d(s(m)),1)])):w("",!0),e("div",{class:"mt-4 text-center"},[e("button",{onClick:j,type:"button",class:"text-sm text-blue-600 hover:text-blue-500"}," Need to setup admin account? ")])])],32)),s(_)?(c(),r("div",ce,[e("p",me,d(s(_)),1)])):w("",!0),e("div",ue,[k(S,{to:"/agency-cms",class:"text-blue-600 hover:text-blue-500 text-sm"},{default:C(()=>[...t[13]||(t[13]=[M(" ‚Üê Back to Website ",-1)])]),_:1})])])])}}};export{xe as default};
