{"version":3,"file":"login-OfJ5YlWx.js","sources":["../../../../../digital-agency/pages/agency-cms/login.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gradient-to-br from-primary-very-light to-primary-light flex items-center justify-center p-4\" style=\"display: flex !important; align-items: center !important; justify-content: center !important; min-height: 100vh !important;\">\n    <div class=\"max-w-md w-full space-y-8\">\n      <!-- Logo -->\n      <div class=\"text-center\">\n        <NuxtLink to=\"/agency-cms\" class=\"text-3xl font-bold gradient-text\">{{ siteSettings.siteName }}</NuxtLink>\n        <h2 class=\"mt-6 text-3xl font-extrabold text-gray-900\">Admin Login</h2>\n        <p class=\"mt-2 text-sm text-gray-600\">Sign in to access the CMS dashboard</p>\n      </div>\n\n      <!-- Setup Form (shown if no admin exists) -->\n      <form v-if=\"showSetup\" @submit.prevent=\"handleSetup\" class=\"mt-8 space-y-6\">\n        <div class=\"card p-8\">\n          <div class=\"mb-6\">\n            <h3 class=\"text-xl font-bold text-gray-900 mb-2\">Setup Admin Account</h3>\n            <p class=\"text-gray-600\">Create the first admin account to access the CMS.</p>\n          </div>\n\n          <div class=\"space-y-4\">\n            <div class=\"relative\">\n              <input \n                v-model=\"setupForm.name\" \n                type=\"text\" \n                placeholder=\" \" \n                class=\"form-input peer\"\n                required\n              >\n              <label class=\"floating-label\">Full Name</label>\n            </div>\n\n            <div class=\"relative\">\n              <input \n                v-model=\"setupForm.email\" \n                type=\"email\" \n                placeholder=\" \" \n                class=\"form-input peer\"\n                required\n              >\n              <label class=\"floating-label\">Email Address</label>\n            </div>\n\n            <div class=\"relative\">\n              <input \n                v-model=\"setupForm.password\" \n                type=\"password\" \n                placeholder=\" \" \n                class=\"form-input peer\"\n                minlength=\"6\"\n                required\n              >\n              <label class=\"floating-label\">Password (min 6 characters)</label>\n            </div>\n          </div>\n\n          <button \n            type=\"submit\" \n            :disabled=\"setupLoading\"\n            class=\"btn-primary w-full mt-6\"\n          >\n            {{ setupLoading ? 'Creating...' : 'Create Admin Account' }}\n          </button>\n\n          <div v-if=\"setupError\" class=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n            <p class=\"text-red-700 text-sm\">{{ setupError }}</p>\n          </div>\n        </div>\n      </form>\n\n      <!-- Login Form -->\n      <form v-else @submit.prevent=\"handleLogin\" class=\"mt-8 space-y-6\">\n        <div class=\"card p-8\">\n          <div class=\"space-y-4\">\n            <div class=\"relative\">\n              <input \n                v-model=\"loginForm.email\" \n                type=\"email\" \n                placeholder=\" \" \n                class=\"form-input peer\"\n                required\n              >\n              <label class=\"floating-label\">Email Address</label>\n            </div>\n\n            <div class=\"relative\">\n              <input \n                v-model=\"loginForm.password\" \n                type=\"password\" \n                placeholder=\" \" \n                class=\"form-input peer\"\n                required\n              >\n              <label class=\"floating-label\">Password</label>\n            </div>\n          </div>\n\n          <button \n            type=\"submit\" \n            :disabled=\"loginLoading\"\n            class=\"btn-primary w-full mt-6\"\n          >\n            {{ loginLoading ? 'Signing in...' : 'Sign In' }}\n          </button>\n\n          <div v-if=\"loginError\" class=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n            <p class=\"text-red-700 text-sm\">{{ loginError }}</p>\n          </div>\n\n          <div class=\"mt-4 text-center\">\n            <button \n              @click=\"checkSetupNeeded\" \n              type=\"button\" \n              class=\"text-sm text-blue-600 hover:text-blue-500\"\n            >\n              Need to setup admin account?\n            </button>\n          </div>\n        </div>\n      </form>\n\n      <!-- Success Message -->\n      <div v-if=\"successMessage\" class=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\n        <p class=\"text-green-700 font-medium\">{{ successMessage }}</p>\n      </div>\n\n      <!-- Back to Home -->\n      <div class=\"text-center\">\n        <NuxtLink to=\"/agency-cms\" class=\"text-blue-600 hover:text-blue-500 text-sm\">\n          ‚Üê Back to Website\n        </NuxtLink>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\ndefinePageMeta({\n  layout: false\n})\n\nconst { login, setupAdmin, isAuthenticated } = useAuth()\nconst { getSiteSettings } = useCMS()\nconst { t, initLanguage } = useI18n()\nconst siteSettings = await getSiteSettings()\n\n// Initialize language system\nonMounted(() => {\n  initLanguage()\n})\n\n// Form data\nconst loginForm = reactive({\n  email: '',\n  password: ''\n})\n\nconst setupForm = reactive({\n  name: '',\n  email: '',\n  password: ''\n})\n\n// Component state\nconst showSetup = ref(false)\nconst loginLoading = ref(false)\nconst setupLoading = ref(false)\nconst loginError = ref('')\nconst setupError = ref('')\nconst successMessage = ref('')\n\n// Check if user is already authenticated\nwatch(isAuthenticated, async (authenticated) => {\n  if (authenticated) {\n    await navigateTo('/agency-cms/manage')\n  }\n}, { immediate: true })\n\n// Methods\nconst handleLogin = async () => {\n  loginLoading.value = true\n  loginError.value = ''\n\n  const result = await login(loginForm.email, loginForm.password)\n\n  if (result.success) {\n    console.log('Login successful, waiting for cookie to be set...')\n    \n    // Wait a moment for the cookie to be set, then redirect\n    setTimeout(async () => {\n      console.log('Redirecting to /manage')\n      await navigateTo('/manage', { replace: true })\n    }, 500)\n  } else {\n    loginError.value = result.error\n    loginLoading.value = false\n  }\n}\n\nconst handleSetup = async () => {\n  setupLoading.value = true\n  setupError.value = ''\n\n  const result = await setupAdmin(\n    setupForm.email, \n    setupForm.password, \n    setupForm.name\n  )\n\n  if (result.success) {\n    successMessage.value = 'Admin account created successfully! You can now login.'\n    showSetup.value = false\n    // Reset setup form\n    setupForm.name = ''\n    setupForm.email = ''\n    setupForm.password = ''\n  } else {\n    setupError.value = result.error\n  }\n\n  setupLoading.value = false\n}\n\nconst checkSetupNeeded = () => {\n  showSetup.value = true\n  loginError.value = ''\n}\n\n// SEO\nuseSeoMeta({\n  title: `Admin Login | ${siteSettings.siteName} CMS`,\n  description: `Login to access the ${siteSettings.siteName} CMS dashboard`,\n  robots: 'noindex, nofollow'\n})\n</script>\n\n\n"],"names":["_withAsyncContext","_push","_parent","_ssrInterpolate","_unref","_createTextVNode","_toDisplayString","_ssrRenderAttr"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA2IA,UAAM,EAAqB,gBAAe,IAAK,QAAO;AACtD,UAAM,EAAE,gBAAe,IAAK,OAAM;AACN,YAAO;AACnC,UAAM,gBAAe,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,gBAAe,CAAC;AAQ3C,UAAM,YAAY,SAAS;AAAA,MACzB,OAAO;AAAA,MACP,UAAU;AAAA,IACZ,CAAC;AAED,UAAM,YAAY,SAAS;AAAA,MACzB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,UAAU;AAAA,IACZ,CAAC;AAGD,UAAM,YAAY,IAAI,KAAK;AAC3B,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,aAAa,IAAI,EAAE;AACzB,UAAM,aAAa,IAAI,EAAE;AACzB,UAAM,iBAAiB,IAAI,EAAE;AAG7B,UAAM,iBAAiB,OAAO,kBAAkB;AAC9C,UAAI,eAAe;AACjB,cAAM,WAAW,oBAAoB;AAAA,MACvC;AAAA,IACF,GAAG,EAAE,WAAW,KAAI,CAAE;AAqDtB,eAAW;AAAA,MACT,OAAO,iBAAiB,aAAa,QAAQ;AAAA,MAC7C,aAAa,uBAAuB,aAAa,QAAQ;AAAA,MACzD,QAAQ;AAAA,IACV,CAAC;;;;QAtOM,OAAM;AAAA,QAA+G,OAAA,EAAA,WAAA,mBAAA,eAAA,qBAAA,mBAAA,qBAAA,cAAA,mBAAA;AAAA;;QAI1G,IAAG;AAAA,QAAc,OAAM;AAAA;yBAAjC,CAA0G,GAAAC,QAAAC,UAAA,aAAA;;AAAnC,YAAAD,OAAA,GAAAE,eAAAC,MAAA,YAAA,EAAa,QAAQ,CAAA,EAAA;AAAA;;cAArBC,gBAAAC,gBAAAF,MAAA,YAAA,EAAa,QAAQ,GAAA,CAAA;AAAA;;;;;;UAMlFA,MAAA,SAAA,GAAS;sSAUFG,cAAA,SAAAH,MAAA,SAAA,EAAU,IAAI,mJAWdG,cAAA,SAAAH,MAAA,SAAA,EAAU,KAAK,wJAWfG,cAAA,SAAAH,MAAA,SAAA,EAAU,QAAQ,4MAapBA,MAAA,YAAA,CAAY,IAAA,cAAA,qDAGpBA,MAAA,YAAA,IAAY,gBAAA,sBAAA;YAGNA,MAAA,UAAA,GAAU;mIACgBA,MAAA,UAAA,CAAU,CAAA,YAAA;AAAA;;;;;uHAWhCG,cAAA,SAAAH,MAAA,SAAA,EAAU,KAAK,wJAWfG,cAAA,SAAAH,MAAA,SAAA,EAAU,QAAQ,2KAYpBA,MAAA,YAAA,CAAY,IAAA,cAAA,qDAGpBA,MAAA,YAAA,IAAY,kBAAA,SAAA;YAGNA,MAAA,UAAA,GAAU;mIACgBA,MAAA,UAAA,CAAU,CAAA,YAAA;AAAA;;;;;UAgBxCA,MAAA,cAAA,GAAc;2IACkBA,MAAA,cAAA,CAAc,CAAA,YAAA;AAAA;;;;;QAK7C,IAAG;AAAA,QAAc,OAAM;AAAA;yBAAjC,CAEW,GAAAH,QAAAC,UAAA,aAAA;;;;;8BAFkE,qBAE7E;AAAA;;;;;;;;;;;;;;;"}